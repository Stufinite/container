!function(e){function t(t){if(files=t.target.files,obj=[],files){for(var a,n=0,o=0;a=files[o];o++){var i=new FileReader;i.onload=function(t){return function(t){var a=t.target.result;obj[n]=e.parseJSON(a),n+=1}}(a),i.readAsText(a)}if_select=1}else alert("Failed to load files")}function a(t,a){e(".file_name."+a).attr("value","上傳成功"),e(".upload_file_name."+a).text("已上傳:"+t),e(".not_upload_file_name").empty(),"submit1"==a&&(localStorage.fileName=t,localStorage.agenda_count=JSON.stringify(agenda_count),localStorage.agenda_name_count=JSON.stringify(agenda_name_count),localStorage.json_num=json_num),if_select=0}function n(t){t["user-name"]=e("#user_name").val(),t["user-dept"]=e("#user_dept").val(),o();var a=e("#user_name").val(),n=JSON.stringify(t),i=new Blob([n],{type:"application/json"});saveAs(i,a+".json")}e(function(){"undefined"!=typeof Storage?(window.agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],window.modify_agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],window.agenda_name_count=[[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}]],window.fileName="",window.modify_userName="",window.modify_userDept="",window.json_num=0,window.obj=[],window.files=[],window.no_one="沒人可以到喔",window.current_name="",window.td_mode=1,window.demo_mode=1,0!=localStorage.length&&(agenda_count=e.parseJSON(localStorage.agenda_count),agenda_name_count=e.parseJSON(localStorage.agenda_name_count),json_num=parseInt(localStorage.json_num),demo_click(agenda_count,json_num,"demo"),fileName=localStorage.fileName,e("#upload_file_name").text("已上傳:"+fileName))):(window.agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],window.modify_agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],window.agenda_name_count=[[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}]],window.fileName="",window.modify_userName="",window.modify_userDept="",window.json_num=0,window.obj=[],window.files=[],window.no_one="沒人可以到喔",window.current_name="",window.td_mode=1,window.demo_mode=1),e(".clear-button").click(function(){i(),e("td").html("<div><span></span></div>"),e("td").attr({style:""})})}),e('input[type="file"]').change(function(t){e(".file_name."+t.target.id).attr("value","共"+t.target.files.length+"個檔案");for(var a="",n=0;n<t.target.files.length;n++)a+=t.target.files[n].name;e(".not_upload_file_name."+t.target.id).text("未上傳:"+a)}),window.if_select=0,document.getElementById("file").addEventListener("change",t,!1),document.getElementById("modify_file").addEventListener("change",t,!1),e("#submit1").click(function(){if_select?(json_num+=obj.length,e.each(obj,function(t,a){has_class=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],e.each(a.time_table,function(t,a){e.each(a.time_parsed,function(t,a){e.each(a.time,function(e,t){agenda_count[a.day-1][t-1]++,has_class[a.day-1][t-1]=1})})}),current_name=a["user-dept"]+":"+a["user-name"]+"<br>",fileName=fileName+a["user-name"]+".json",e.each(has_class,function(t,n){e.each(n,function(n,o){if(0==o){var i=0;if(!jQuery.isEmptyObject(agenda_name_count[t][n])){var d=agenda_name_count[t][n];e.each(d,function(e,o){return e==a["user-dept"]?(o+=current_name,i=1,agenda_name_count[t][n][a["user-dept"]]=o,!1):void 0})}0==i&&(agenda_name_count[t][n][a["user-dept"]]=current_name)}})})}),a(fileName,"submit1")):toastr.warning("尚未選擇檔案!")}),e("#submit2").click(function(){if(if_select){modify_agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]];var t="";e.each(obj,function(t,a){e.each(a.time_table,function(t,a){e.each(a.time_parsed,function(t,a){e.each(a.time,function(e,t){modify_agenda_count[a.day-1][t-1]=1})})})}),t=obj[0]["user-name"]+".json",a(t,"submit2"),modify_userName=obj[0]["user-name"],modify_userDept=obj[0]["user-dept"]}else toastr.warning("尚未選擇檔案!")}),e("#demo").click(function(){demo_click(agenda_count,json_num,"demo"),td_mode=1,demo_mode=1}),e(".demo2").click(function(){demo_click(modify_agenda_count,1,"demo2"),td_mode=2,demo_mode=2}),window.demo_click=function(t,a,n){e("td").html("<div><span></span></div>"),e("td").attr({style:""}),e.each(t,function(t,o){e.each(o,function(o,i){var d="",l=e("#time-table").find("tr[data-hour="+(o+1)+"] td[data-day="+(t+1)+"]"),c=e("#time-table").find("tr[data-hour="+(o+1)+"] td[data-day="+(t+1)+"] div"),r=e("#time-table").find("tr[data-hour="+(o+1)+"] td[data-day="+(t+1)+"] span"),m="";if(jQuery.isEmptyObject(agenda_name_count[t][o]))m=no_one;else{var s=agenda_name_count[t][o];e.each(s,function(e,t){m+=t})}"demo"==n&&c.attr({"data-toggle":"tooltip","data-html":"true","data-placement":d,title:m,style:"height: 80%;width:100%","class":"table_name"}),r.attr({"class":"",style:"color:black;font-weight:bold"}),d=5>o+1?"bottom":"top",i>=0&&a/4>=i&&i!=a?(c.attr({"data-placement":d}),l.attr({style:"color:#3074B5;background-color:#58FA58"}),r.html("<h1>"+(a-i)+"</h1>")):i>a/4&&a/2>=i&&i!=a?(c.attr({"data-placement":d}),l.attr({style:"color:#3074B5;background-color:#81F7F3"}),r.html("<h1>"+(a-i)+"</h1>")):i>a/2&&3*a/4>=i&&i!=a?(c.attr({"data-placement":d}),l.attr({style:"color:#3074B5;background-color:#F4FA58"}),r.html("<h1>"+(a-i)+"</h1>")):i>3*a/4&&a>i&&i!=a?(c.attr({"data-placement":d}),l.attr({style:"color:#3074B5;background-color:#FF8000"}),r.html("<h1>"+(a-i)+"</h1>")):(c.attr({"data-placement":d}),l.attr({style:"color:#3074B5;background-color:#FA5858"}),r.html("<h1>"+(a-i)+"</h1>")),"demo"==n&&e('[data-toggle="tooltip"]').tooltip()})}),e('#tab a[href="#profile"]').tab("show")},e("td").click(function(){if(1==td_mode){var t=e(this).find(".table_name").attr("data-original-title");td_click(t)}else{"rgb(250, 88, 88)"==e(this).css("background-color")?(e(this).css("background-color","rgb(88, 250, 88)"),modify_agenda_count[e(this).attr("data-day")-1][e(this).parent().attr("data-hour")-1]=0):(e(this).css("background-color","rgb(250, 88, 88)"),modify_agenda_count[e(this).attr("data-day")-1][e(this).parent().attr("data-hour")-1]=1);var a=e(this).find("span").text();e(this).find("span").html("<h1>"+(1-a)+"</h1>")}}),window.json={"user-name":"","user-dept":"",time_table:[]},e("#download_json").click(function(){json={"user-name":"","user-dept":"",time_table:[]},e.each(modify_agenda_count,function(t,a){var n={time_parsed:[{day:1,time:[]}]};n.time_parsed[0].day=t+1;var o=0;e.each(a,function(e,t){1==t&&(t+=o,n.time_parsed[0].time.push(t)),o+=1}),json.time_table.push(n)}),n(json)});var o=function(){"undefined"!=typeof Storage&&(stringify=JSON.stringify(window.user),localStorage.jsonstorage=stringify)};toastr.options={preventDuplicates:!0},window.td_click=function(t){t?(e("#name_box_content").attr({style:"padding-top:3px;padding-left:3px;padding-bottom:3px"}),e("#name_box_content").html("<h4>"+t+"</h4>")):toastr.warning("尚未分析資料!")};var i=function(){e("#time-table td").empty(),window.credits=0,e("#class_credit").text(window.credits),window.name_of_optional_obligatory=[],1==demo_mode?(agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],agenda_name_count=[[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{},{},{},{},{}]],json_num=0,fileName="",e(".file_name.submit1").attr("value","尚未選擇檔案"),e(".upload_file_name.submit1").empty(),e(".file.not_upload_file_name").empty(),localStorage.clear()):(modify_agenda_count=[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],e(".file_name.submit2").attr("value","尚未選擇檔案"),e(".upload_file_name.submit2").empty(),e(".modify_file.not_upload_file_name").empty(),modify_userName="",modify_userDept=""),obj=[],files=[],e("#name_box_content").attr({style:""}),e("#name_box_content").html("")}}(jQuery);